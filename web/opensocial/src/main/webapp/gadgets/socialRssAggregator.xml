<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="__UP_mtitle__" title_url="__UP_titlelink__" directory_title="Social RSS Reader">
<Require feature="dynamic-height" />
<Require feature="setprefs"/>
<Require feature="minimessage"/>
<Require feature="opensocial-0.7"></Require>
<Require feature="settitle"></Require>
</ModulePrefs>
    <UserPref name="mtitle" display_name="Title name" default_value="Social RSS Reader"/>
	<UserPref name="rssurl" display_name="FEED URL" default_value="http://blog.exoplatform.org/feed/" required="true" />
	<UserPref name="title" display_name="Custom Gadget Title" default_value="CustomRSS" />
	<UserPref name="num_entries" display_name="# of Items (1-100)" default_value="10"/>
    <!-- design var -->
	<UserPref name="dborder" display_name="Open Border Color" default_value="DFCE6F"/>
	<UserPref name="tcolor" display_name="Open Title Color" default_value="1C57A9"/>
	<UserPref name="thighlight" display_name="Open Title Bgrnd" default_value="FFF19D"/>
<Content type="html"><![CDATA[
<link rel="stylesheet" type="text/css" href="rssAggregator/style.css"></link>

<script type="text/javascript" src="rssAggregator/script.js"></script>
<div id=""></div>
<div id="feedContainer"></div>

<script type="text/javascript">
    var prefs = new _IG_Prefs(__MODULE_ID__);
    var entries = prefs.getInt("num_entries");
    var feedurl = prefs.getString("rssurl");

    if (isNaN(entries)) {
      entries = 10;
    }
    else {
      if (entries < 1) { entries = 1; }
      if (entries > 100) { entries = 100; }
    }
	
	RssAggregator.prototype.shared = function() {
	  var miniMsg = new gadgets.MiniMessage();
	  miniMsg.createTimerMessage('Successfully shared.', 7);
	}
	
	RssAggregator.prototype.share = function(entryId) {
	  var activity = opensocial.newActivity({ 'title' : this.feed.Entry[entryId].Title,
	    'body' : "share the link " + this.feed.Entry[entryId].Title + ": " + this.feed.Entry[entryId].Link,
		'url': this.feed.Entry[entryId].Link});

	  opensocial.requestCreateActivity(activity, "HIGH", rssAggregator.shared);
	}
	
	RssAggregator.prototype.generateLinkContent = function(i) {
	  return "<a href='javascript:rssAggregator.share(" + i + ")'>Share</a> | <a href='" + this.feed.Entry[i].Link + "' target='_blank'>view link &raquo;</a>";
	}
	
    var rssAggregator = new RssAggregator();
    gadgets.util.registerOnLoadHandler(rssAggregator.refreshFeed);
</script>

]]>
</Content>
</Module>