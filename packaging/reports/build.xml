<?xml version="1.0"?>
<!--

    Copyright (C) 2009 eXo Platform SAS.
    
    This is free software; you can redistribute it and/or modify it
    under the terms of the GNU Lesser General Public License as
    published by the Free Software Foundation; either version 2.1 of
    the License, or (at your option) any later version.
    
    This software is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
    Lesser General Public License for more details.
    
    You should have received a copy of the GNU Lesser General Public
    License along with this software; if not, write to the Free
    Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
    02110-1301 USA, or see the FSF site: http://www.fsf.org.

-->

<project name="JBoss Tattletale report generator" 
	 default="generate-report"
	 xmlns:tattletale="antlib:org.jboss.tattletale.ant"
	 xmlns:contrib="antlib:net.sf.antcontrib">
  	
  <target name="generate-report">
  	
  	<available file="${jboss_scan_dir}" property="perform_jboss_scan"/>
  	<available file="${tomcat_scan_dir}" property="perform_tomcat_scan"/>
 	
  	<contrib:if>
  	  <contrib:equals arg1="${perform_jboss_scan}" arg2="true"/>
  	  <contrib:then>
  	  	<antcall target="generate-report-from-jboss" />
  	  </contrib:then>
  	</contrib:if>
  	
  	<contrib:if>
  	  <contrib:equals arg1="${perform_tomcat_scan}" arg2="true"/>
  	  <contrib:then>
  	  	<antcall target="generate-report-from-tomcat" />
  	  </contrib:then>
  	</contrib:if>
  </target>
	
  <target name="generate-report-from-jboss">
  	<echo message="Report based on JBoss deploy" />
  	<echo message="Tattletale scan dir: ${jboss_scan_dir}" />
    <echo message="Tattletale output dir: ${jboss_output_dir}" />
	<echo message="Generating ..." />
  	
	<tattletale:report scanDir="${jboss_scan_dir}" outputDir="${jboss_output_dir}" />
  </target>
	
  <target name="generate-report-from-tomcat">
  	<echo message="Report based on Tomcat deploy" />
  	<echo message="Tattletale scan dir: ${tomcat_scan_dir}" />
    <echo message="Tattletale output dir: ${tomcat_output_dir}" />
	<echo message="Generating ..." />
	  	
	<tattletale:report scanDir="${tomcat_scan_dir}" outputDir="${tomcat_output_dir}" />
  </target>

</project>
